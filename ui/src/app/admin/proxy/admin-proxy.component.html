<div class="admin-section-content admin-proxy">
  <p class="small text-muted mb-3">
    Configure the maximum size allowed for direct proxy downloads. These settings apply to all users.
  </p>

  <div class="alert alert-danger py-2" role="alert" *ngIf="proxySettingsError">
    {{ proxySettingsError }}
    <button type="button" class="btn btn-link btn-sm ms-2" (click)="refreshProxySettings()" [disabled]="proxySettingsLoading">Retry</button>
  </div>

  <div class="d-flex align-items-center gap-2 mb-3" *ngIf="proxySettingsLoading">
    <div class="spinner-border spinner-border-sm" role="status"></div>
    <span>Loading proxy settingsâ€¦</span>
  </div>

  <ng-container *ngIf="!proxySettingsLoading">
    <div class="form-check form-switch mb-3">
      <input class="form-check-input"
             type="checkbox"
             id="proxyLimitToggle"
             [checked]="proxyLimitEnabled"
             (change)="onProxyLimitToggle($event.target.checked)"
             [disabled]="proxySettingsSaving">
      <label class="form-check-label" for="proxyLimitToggle">Enforce download size limit</label>
    </div>

    <div class="mb-3">
      <label class="form-label" for="proxyLimitMb">Maximum size (MB)</label>
      <input id="proxyLimitMb"
             type="number"
             class="form-control"
             min="0"
             [value]="proxyLimitMb"
             (input)="onProxyLimitMbChange($event.target.value)"
             (change)="onProxyLimitMbChange($event.target.value)"
             (blur)="onProxyLimitMbChange($event.target.value)"
             [disabled]="proxySettingsSaving || !proxyLimitEnabled">
      <small class="text-muted">Set to 0 for unlimited downloads.</small>
    </div>

    <div class="d-flex justify-content-end">
      <button type="button"
              class="btn btn-primary"
              (click)="saveProxySettings()"
              [disabled]="proxySettingsSaving || !proxySettingsDirty">
        <span *ngIf="proxySettingsSaving" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
        Save changes
      </button>
    </div>
  </ng-container>
</div>
